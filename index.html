<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Agent Workflow Builder</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:system-ui;background:#f8f9fa}
#container{max-width:100%;margin:0 auto}
#left{padding:20px;background:#fff;border-bottom:3px solid #e9ecef}
#right{padding:20px;min-height:400px}
h2{font-size:18px;margin-bottom:15px;color:#212529}
.workflow{margin-bottom:20px;padding:15px;background:#f8f9fa;border-radius:8px;border:2px solid #dee2e6}
.workflow>input{width:100%;padding:12px;margin-bottom:12px;border:2px solid #dee2e6;border-radius:6px;font-size:15px;font-weight:600}
.workflow>input:focus{outline:none;border-color:#6366f1}
.step{margin-bottom:10px;display:flex;gap:8px;align-items:stretch}
.step input{flex:1;padding:12px;border:2px solid #dee2e6;border-radius:6px;font-size:14px;min-height:44px}
.step input:focus{outline:none;border-color:#6366f1}
.step button{width:44px;height:44px;background:#ef4444;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:20px;font-weight:bold;flex-shrink:0}
button{padding:12px;background:#6366f1;color:#fff;border:none;border-radius:6px;cursor:pointer;font-weight:600;font-size:14px;width:100%;margin-top:8px}
button:hover{opacity:0.9}
.add-step{background:#10b981}
.add-workflow{background:#8b5cf6}
.remove-workflow{background:#ef4444}
.gen-btn{background:#6366f1;font-size:16px;padding:15px;position:sticky;top:0;z-index:10;box-shadow:0 2px 8px rgba(0,0,0,0.1)}
.flow-item{margin-bottom:35px;background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.05)}
.flow-header{display:flex;align-items:center;margin-bottom:20px;gap:15px}
.flow-num{font-size:28px;font-weight:bold;color:#adb5bd;min-width:40px}
.flow-label{font-weight:600;color:#495057;font-size:16px;flex:1}
.flow-steps{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
.box{padding:12px 16px;border-radius:8px;border:2px solid;font-size:13px;font-weight:500;min-width:100px;text-align:center;word-break:break-word}
.arrow{font-size:20px;color:#adb5bd;user-select:none}
.trigger{background:#fef3c7;border-color:#f59e0b;color:#92400e}
.action{background:#dbeafe;border-color:#3b82f6;color:#1e40af}
.check{background:#d1fae5;border-color:#10b981;color:#065f46}
.ai{background:#f3e8ff;border-color:#a855f7;color:#6b21a8}
.final{background:#d1fae5;border-color:#10b981;color:#065f46}
#download{background:#059669;margin-top:15px}
.empty{text-align:center;color:#adb5bd;padding:60px 20px;font-size:16px}
@media(min-width:768px){
#container{display:flex;height:100vh}
#left{width:400px;border-bottom:none;border-right:3px solid #e9ecef;overflow-y:auto}
#right{flex:1;overflow-y:auto}
.box{font-size:14px;padding:14px 18px}
}
</style>
</head>
<body>
<div id="container">
<div id="left">
<h2>AI Agent Workflows</h2>
<div id="workflows"></div>
<button class="add-workflow" onclick="addWorkflow()">+ Add Workflow</button>
<button class="gen-btn" onclick="generate()">Generate Diagram</button>
</div>
<div id="right">
<div class="empty">Add workflows and click Generate to see your diagram</div>
</div>
</div>

<script>
let workflows=[];

function addWorkflow(){
workflows.push({name:'',steps:['','']});
render();
}

function removeWorkflow(i){
workflows.splice(i,1);
render();
}

function addStep(wi){
workflows[wi].steps.push('');
render();
}

function removeStep(wi,si){
if(workflows[wi].steps.length>1){
workflows[wi].steps.splice(si,1);
render();
}
}

function updateName(wi,val){
workflows[wi].name=val;
}

function updateStep(wi,si,val){
workflows[wi].steps[si]=val;
}

function render(){
const c=document.getElementById('workflows');
c.innerHTML=workflows.map((w,wi)=>`
<div class="workflow">
<input placeholder="Workflow Name (e.g., Create CRM Entry)" value="${w.name}" oninput="updateName(${wi},this.value)">
${w.steps.map((s,si)=>`
<div class="step">
<input placeholder="Step ${si+1}" value="${s}" oninput="updateStep(${wi},${si},this.value)">
<button onclick="removeStep(${wi},${si})">×</button>
</div>
`).join('')}
<button class="add-step" onclick="addStep(${wi})">+ Add Step</button>
<button class="remove-workflow" onclick="removeWorkflow(${wi})">Remove Workflow</button>
</div>
`).join('');
}

function getStepClass(step,idx,total){
if(idx===0)return 'trigger';
if(idx===total-1)return 'final';
if(step.toLowerCase().includes('check')||step.toLowerCase().includes('daily'))return 'check';
if(step.toLowerCase().includes('ai')||step.toLowerCase().includes('agent'))return 'ai';
return 'action';
}

function generate(){
const out=document.getElementById('right');
if(workflows.length===0||workflows.every(w=>!w.steps.some(s=>s.trim()))){
out.innerHTML='<div class="empty">Add workflows and steps to generate diagram</div>';
return;
}
out.innerHTML=`
${workflows.map((w,i)=>`
<div class="flow-item">
<div class="flow-header">
<div class="flow-num">${i+1}</div>
<div class="flow-label">${w.name||'Workflow '+(i+1)}</div>
</div>
<div class="flow-steps">
${w.steps.filter(s=>s.trim()).map((s,si,arr)=>`
<div class="box ${getStepClass(s,si,arr.length)}">${s}</div>
${si<arr.length-1?'<div class="arrow">→</div>':''}
`).join('')}
</div>
</div>
`).join('')}
<button id="download" onclick="downloadImg()">Download as Image</button>
`;
}

function downloadImg(){
const el=document.getElementById('right');
html2canvas(el,{backgroundColor:'#f8f9fa',scale:2}).then(canvas=>{
const link=document.createElement('a');
link.download='workflow-diagram.png';
link.href=canvas.toDataURL();
link.click();
});
}

addWorkflow();
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

</body>
</html>
